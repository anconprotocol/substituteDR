"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const ava_1 = __importDefault(require("ava"));
const parkydb_1 = require("parkydb");
const dataRender_1 = require("../src/core/dataRender");
const payload = {
    commitHash: "xg8pyBr3McqYlUgxAqV0t3s6TRcP+B7MHyPTtyVKMJw=",
    contentHash: {
        "/": "baguqeerahiqryfzwbjc2fn7is4k2uupilwtoxabtb6noifnwxznxszuvrg6a",
    },
    digest: "0x5ab3124ede7a511fbc7c6302b164d1547aefda8b5909b6bb637c7da025c3ffaf",
    height: 207,
    issuer: "0x32A21c1bB6E7C20F547e930b53dAC57f42cd25F6",
    key: "YW5jb25wcm90b2NvbC91c2Vycy9kaWQ6ZXRocjpibmJ0OjB4MzJBMjFjMWJCNkU3QzIwRjU0N2U5MzBiNTNkQUM1N2Y0MmNkMjVGNi9iYWd1cWVlcmFoaXFyeWZ6d2JqYzJmbjdpczRrMnV1cGlsd3RveGFidGI2bm9pZm53eHpueHN6dXZyZzZh",
    lastBlockHash: {
        "/": "baguqeeraw4ssfjictj2b47cccep2oioytbjistjke2xuaa35qgdoivtgrwra",
    },
    network: "anconprotocol",
    parentHash: {
        "/": "baguqeerakv6jersryhhanjaihmb2ncdujajxt7gpkfzs7rkur7lo4s5uecwa",
    },
    rootKey: "YW5jb25wcm90b2NvbC91c2Vycy9kaWQ6ZXRocjpibmJ0OjB4MzJBMjFjMWJCNkU3QzIwRjU0N2U5MzBiNTNkQUM1N2Y0MmNkMjVGNg==",
    signature: "0xa628e3e256a187453c55ffbebc189ec4464c6c0d874a278272d224dbbaa4f6f028d3550651c33edf7af0ea8b3f3806d09ba9135034a61dd1a651c67f83cb06a51b",
    timestamp: 1645384767,
    content: {
        blockchainTokenId: "8",
        blockchainTxHash: "0x977dd680952c4f7da1040d12a0a2c9e68a60f6158edee20b1591f91372030670",
        creator: "0x32A21c1bB6E7C20F547e930b53dAC57f42cd25F6",
        currentOrderHash: "",
        description: "me and friends",
        fileExtension: "jpg",
        image: "baguqeerar56ywt7p3qbbf6wiqgja5ybvkblz4wx37vyybthr2jl65d657jha",
        name: "Sweden 90s",
        owner: "0x32A21c1bB6E7C20F547e930b53dAC57f42cd25F6",
        price: "",
        sources: [
            "https://tensta.did.pa/v0/file/baguqeerar56ywt7p3qbbf6wiqgja5ybvkblz4wx37vyybthr2jl65d657jha/",
        ],
        tags: "DiseÃ±o grafico",
        uuid: "854198e4-1c09-4c27-8103-2ae54adfc681",
    },
};
ava_1.default.beforeEach(async (t) => {
    const alice = new parkydb_1.ParkyDB();
    await alice.initialize({
        withWallet: {
            password: "qwerty",
            seed: "window alpha view text barely urge minute nasty motion curtain need dinosaur",
        },
    });
    const bob = new parkydb_1.ParkyDB();
    await bob.initialize({
        withWallet: {
            password: "zxcvb",
            seed: "opera offer craft joke defy team prosper tragic reopen street advice moral",
        },
    });
    t.context = {
        db: alice,
        alice,
        bob,
    };
});
(0, ava_1.default)("render server", async (t) => {
    const data = await (0, dataRender_1.main)();
    console.log(data);
});
(0, ava_1.default)("create topic", async (t) => {
    const { alice, bob } = t.context;
    await alice.wallet.addSecp256k1([
        "c87509a1c067bbde78beb793e6fa76530b6382a4c0241e5e4a9ec0a0f44dc0d3",
    ]);
    await alice.wallet.submitPassword(`qwerty`);
    let accounts = await alice.wallet.getAccounts();
    t.is(accounts.length, 1);
    const accountA = accounts[0];
    await bob.wallet.submitPassword(`zxcvb`);
    accounts = await alice.wallet.getAccounts();
    t.is(accounts.length, 1);
    const accountB = accounts[0];
    const topic = `/anconprotocol/1/marketplace/ipld-dag-json`;
    const pubsubAlice = await alice.createTopicPubsub(topic);
    pubsubAlice.onBlockReply$.subscribe(async (block) => {
        t.is(topic, JSON.parse(block.payloadAsUtf8).topic);
    });
    const pubsubBob = await bob.createTopicPubsub(topic);
    pubsubBob.onBlockReply$.subscribe(async (block) => {
        t.is(topic, JSON.parse(block.payloadAsUtf8).topic);
        await bob.putBlock(payload, { topic });
    });
    await alice.putBlock(payload, { topic });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWVzc2FnaW5nLnRlc3QuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi90ZXN0L21lc3NhZ2luZy50ZXN0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7O0FBQ0EsOENBQXVCO0FBTXZCLHFDQUFrQztBQUNsQyx1REFBOEM7QUFHOUMsTUFBTSxPQUFPLEdBQUc7SUFDZCxVQUFVLEVBQUUsOENBQThDO0lBQzFELFdBQVcsRUFBRTtRQUNYLEdBQUcsRUFBRSwrREFBK0Q7S0FDckU7SUFDRCxNQUFNLEVBQ0osb0VBQW9FO0lBQ3RFLE1BQU0sRUFBRSxHQUFHO0lBQ1gsTUFBTSxFQUFFLDRDQUE0QztJQUNwRCxHQUFHLEVBQUUsMExBQTBMO0lBQy9MLGFBQWEsRUFBRTtRQUNiLEdBQUcsRUFBRSwrREFBK0Q7S0FDckU7SUFDRCxPQUFPLEVBQUUsZUFBZTtJQUN4QixVQUFVLEVBQUU7UUFDVixHQUFHLEVBQUUsK0RBQStEO0tBQ3JFO0lBQ0QsT0FBTyxFQUNMLDBHQUEwRztJQUM1RyxTQUFTLEVBQ1Asc0lBQXNJO0lBQ3hJLFNBQVMsRUFBRSxVQUFVO0lBQ3JCLE9BQU8sRUFBRTtRQUNQLGlCQUFpQixFQUFFLEdBQUc7UUFDdEIsZ0JBQWdCLEVBQ2Qsb0VBQW9FO1FBQ3RFLE9BQU8sRUFBRSw0Q0FBNEM7UUFDckQsZ0JBQWdCLEVBQUUsRUFBRTtRQUNwQixXQUFXLEVBQUUsZ0JBQWdCO1FBQzdCLGFBQWEsRUFBRSxLQUFLO1FBQ3BCLEtBQUssRUFDSCwrREFBK0Q7UUFDakUsSUFBSSxFQUFFLFlBQVk7UUFDbEIsS0FBSyxFQUFFLDRDQUE0QztRQUNuRCxLQUFLLEVBQUUsRUFBRTtRQUNULE9BQU8sRUFBRTtZQUNQLDhGQUE4RjtTQUMvRjtRQUNELElBQUksRUFBRSxnQkFBZ0I7UUFDdEIsSUFBSSxFQUFFLHNDQUFzQztLQUM3QztDQUNGLENBQUM7QUFFRixhQUFJLENBQUMsVUFBVSxDQUFDLEtBQUssRUFBRSxDQUFDLEVBQUUsRUFBRTtJQUMxQixNQUFNLEtBQUssR0FBRyxJQUFJLGlCQUFPLEVBQUUsQ0FBQztJQUM1QixNQUFNLEtBQUssQ0FBQyxVQUFVLENBQUM7UUFFckIsVUFBVSxFQUFFO1lBQ1YsUUFBUSxFQUFFLFFBQVE7WUFDbEIsSUFBSSxFQUFFLDhFQUE4RTtTQUNyRjtLQUNGLENBQUMsQ0FBQztJQUVILE1BQU0sR0FBRyxHQUFHLElBQUksaUJBQU8sRUFBRSxDQUFDO0lBQzFCLE1BQU0sR0FBRyxDQUFDLFVBQVUsQ0FBQztRQUVuQixVQUFVLEVBQUU7WUFDVixRQUFRLEVBQUUsT0FBTztZQUNqQixJQUFJLEVBQUUsNEVBQTRFO1NBQ25GO0tBQ0YsQ0FBQyxDQUFDO0lBRUgsQ0FBQyxDQUFDLE9BQU8sR0FBRztRQUNWLEVBQUUsRUFBRSxLQUFLO1FBQ1QsS0FBSztRQUNMLEdBQUc7S0FDSixDQUFDO0FBQ0osQ0FBQyxDQUFDLENBQUM7QUFDSCxJQUFBLGFBQUksRUFBQyxlQUFlLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxFQUFFO0lBQ2hDLE1BQU0sSUFBSSxHQUFHLE1BQU0sSUFBQSxpQkFBSSxHQUFFLENBQUM7SUFDMUIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNwQixDQUFDLENBQUMsQ0FBQztBQUNILElBQUEsYUFBSSxFQUFDLGNBQWMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLEVBQUU7SUFDL0IsTUFBTSxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsR0FDbEIsQ0FBQyxDQUFDLE9BQWMsQ0FBQztJQUVuQixNQUFNLEtBQUssQ0FBQyxNQUFNLENBQUMsWUFBWSxDQUFDO1FBQzlCLGtFQUFrRTtLQUNuRSxDQUFDLENBQUM7SUFFSCxNQUFNLEtBQUssQ0FBQyxNQUFNLENBQUMsY0FBYyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQzVDLElBQUksUUFBUSxHQUFHLE1BQU0sS0FBSyxDQUFDLE1BQU0sQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUNoRCxDQUFDLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDekIsTUFBTSxRQUFRLEdBQUcsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBRzdCLE1BQU0sR0FBRyxDQUFDLE1BQU0sQ0FBQyxjQUFjLENBQUMsT0FBTyxDQUFDLENBQUM7SUFDekMsUUFBUSxHQUFHLE1BQU0sS0FBSyxDQUFDLE1BQU0sQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUM1QyxDQUFDLENBQUMsRUFBRSxDQUFDLFFBQVEsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDekIsTUFBTSxRQUFRLEdBQUcsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBRTdCLE1BQU0sS0FBSyxHQUFHLDRDQUE0QyxDQUFDO0lBQzNELE1BQU0sV0FBVyxHQUFHLE1BQU0sS0FBSyxDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3pELFdBQVcsQ0FBQyxhQUFhLENBQUMsU0FBUyxDQUFDLEtBQUssRUFBRSxLQUFrQixFQUFFLEVBQUU7UUFFL0QsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxLQUFLLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDckQsQ0FBQyxDQUFDLENBQUM7SUFDSCxNQUFNLFNBQVMsR0FBRyxNQUFNLEdBQUcsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNyRCxTQUFTLENBQUMsYUFBYSxDQUFDLFNBQVMsQ0FBQyxLQUFLLEVBQUUsS0FBa0IsRUFBRSxFQUFFO1FBRTdELENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ25ELE1BQU0sR0FBRyxDQUFDLFFBQVEsQ0FBQyxPQUFPLEVBQUUsRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO0lBQ3pDLENBQUMsQ0FBQyxDQUFDO0lBR0gsTUFBTSxLQUFLLENBQUMsUUFBUSxDQUFDLE9BQU8sRUFBRSxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUM7QUFDM0MsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkZWNvZGUsIGVuY29kZSB9IGZyb20gXCJjYm9yLXhcIjtcbmltcG9ydCB0ZXN0IGZyb20gXCJhdmFcIjtcbmltcG9ydCB7IFdha3VNZXNzYWdlIH0gZnJvbSBcImpzLXdha3VcIjtcbi8vIGltcG9ydCB7IEJ5dGVWaWV3IH0gZnJvbSBcIm11bHRpZm9ybWF0cy9jb2RlY3MvaW50ZXJmYWNlXCI7XG4vLyBpbXBvcnQgeyBtYXAsIHRhcCB9IGZyb20gXCJyeGpzXCI7XG4vLyBpbXBvcnQgeyBDaGFubmVsQ29kZUVudW0gfSBmcm9tIFwicGFya3lkYi9zcmMvaW50ZXJmYWNlcy9CbG9ja0NvZGVjXCI7XG4vLyBpbXBvcnQgeyBCbG9ja1ZhbHVlIH0gZnJvbSBcInBhcmt5ZGIvc3JjL2ludGVyZmFjZXMvQmxvY2t2YWx1ZVwiO1xuaW1wb3J0IHsgUGFya3lEQiB9IGZyb20gXCJwYXJreWRiXCI7XG5pbXBvcnQgeyBtYWluIH0gZnJvbSBcIi4uL3NyYy9jb3JlL2RhdGFSZW5kZXJcIjtcbi8vIGltcG9ydCB7IE1lc3NhZ2luZ1NlcnZpY2UgfSBmcm9tIFwicGFya3lkYi9zcmMvY29yZS9tZXNzYWdpbmdcIjtcblxuY29uc3QgcGF5bG9hZCA9IHtcbiAgY29tbWl0SGFzaDogXCJ4ZzhweUJyM01jcVlsVWd4QXFWMHQzczZUUmNQK0I3TUh5UFR0eVZLTUp3PVwiLFxuICBjb250ZW50SGFzaDoge1xuICAgIFwiL1wiOiBcImJhZ3VxZWVyYWhpcXJ5Znp3YmpjMmZuN2lzNGsydXVwaWx3dG94YWJ0YjZub2lmbnd4em54c3p1dnJnNmFcIixcbiAgfSxcbiAgZGlnZXN0OlxuICAgIFwiMHg1YWIzMTI0ZWRlN2E1MTFmYmM3YzYzMDJiMTY0ZDE1NDdhZWZkYThiNTkwOWI2YmI2MzdjN2RhMDI1YzNmZmFmXCIsXG4gIGhlaWdodDogMjA3LFxuICBpc3N1ZXI6IFwiMHgzMkEyMWMxYkI2RTdDMjBGNTQ3ZTkzMGI1M2RBQzU3ZjQyY2QyNUY2XCIsXG4gIGtleTogXCJZVzVqYjI1d2NtOTBiMk52YkM5MWMyVnljeTlrYVdRNlpYUm9janBpYm1KME9qQjRNekpCTWpGak1XSkNOa1UzUXpJd1JqVTBOMlU1TXpCaU5UTmtRVU0xTjJZME1tTmtNalZHTmk5aVlXZDFjV1ZsY21Gb2FYRnllV1o2ZDJKcVl6Sm1iamRwY3pSck1uVjFjR2xzZDNSdmVHRmlkR0kyYm05cFptNTNlSHB1ZUhONmRYWnlaelpoXCIsXG4gIGxhc3RCbG9ja0hhc2g6IHtcbiAgICBcIi9cIjogXCJiYWd1cWVlcmF3NHNzZmppY3RqMmI0N2NjY2VwMm9pb3l0Ymppc3Rqa2UyeHVhYTM1cWdkb2l2dGdyd3JhXCIsXG4gIH0sXG4gIG5ldHdvcms6IFwiYW5jb25wcm90b2NvbFwiLFxuICBwYXJlbnRIYXNoOiB7XG4gICAgXCIvXCI6IFwiYmFndXFlZXJha3Y2amVyc3J5aGhhbmphaWhtYjJuY2R1amFqeHQ3Z3BrZnpzN3JrdXI3bG80czV1ZWN3YVwiLFxuICB9LFxuICByb290S2V5OlxuICAgIFwiWVc1amIyNXdjbTkwYjJOdmJDOTFjMlZ5Y3k5a2FXUTZaWFJvY2pwaWJtSjBPakI0TXpKQk1qRmpNV0pDTmtVM1F6SXdSalUwTjJVNU16QmlOVE5rUVVNMU4yWTBNbU5rTWpWR05nPT1cIixcbiAgc2lnbmF0dXJlOlxuICAgIFwiMHhhNjI4ZTNlMjU2YTE4NzQ1M2M1NWZmYmViYzE4OWVjNDQ2NGM2YzBkODc0YTI3ODI3MmQyMjRkYmJhYTRmNmYwMjhkMzU1MDY1MWMzM2VkZjdhZjBlYThiM2YzODA2ZDA5YmE5MTM1MDM0YTYxZGQxYTY1MWM2N2Y4M2NiMDZhNTFiXCIsXG4gIHRpbWVzdGFtcDogMTY0NTM4NDc2NyxcbiAgY29udGVudDoge1xuICAgIGJsb2NrY2hhaW5Ub2tlbklkOiBcIjhcIixcbiAgICBibG9ja2NoYWluVHhIYXNoOlxuICAgICAgXCIweDk3N2RkNjgwOTUyYzRmN2RhMTA0MGQxMmEwYTJjOWU2OGE2MGY2MTU4ZWRlZTIwYjE1OTFmOTEzNzIwMzA2NzBcIixcbiAgICBjcmVhdG9yOiBcIjB4MzJBMjFjMWJCNkU3QzIwRjU0N2U5MzBiNTNkQUM1N2Y0MmNkMjVGNlwiLFxuICAgIGN1cnJlbnRPcmRlckhhc2g6IFwiXCIsXG4gICAgZGVzY3JpcHRpb246IFwibWUgYW5kIGZyaWVuZHNcIixcbiAgICBmaWxlRXh0ZW5zaW9uOiBcImpwZ1wiLFxuICAgIGltYWdlOlxuICAgICAgXCJiYWd1cWVlcmFyNTZ5d3Q3cDNxYmJmNndpcWdqYTV5YnZrYmx6NHd4Mzd2eXlidGhyMmpsNjVkNjU3amhhXCIsXG4gICAgbmFtZTogXCJTd2VkZW4gOTBzXCIsXG4gICAgb3duZXI6IFwiMHgzMkEyMWMxYkI2RTdDMjBGNTQ3ZTkzMGI1M2RBQzU3ZjQyY2QyNUY2XCIsXG4gICAgcHJpY2U6IFwiXCIsXG4gICAgc291cmNlczogW1xuICAgICAgXCJodHRwczovL3RlbnN0YS5kaWQucGEvdjAvZmlsZS9iYWd1cWVlcmFyNTZ5d3Q3cDNxYmJmNndpcWdqYTV5YnZrYmx6NHd4Mzd2eXlidGhyMmpsNjVkNjU3amhhL1wiLFxuICAgIF0sXG4gICAgdGFnczogXCJEaXNlw7FvIGdyYWZpY29cIixcbiAgICB1dWlkOiBcIjg1NDE5OGU0LTFjMDktNGMyNy04MTAzLTJhZTU0YWRmYzY4MVwiLFxuICB9LFxufTtcblxudGVzdC5iZWZvcmVFYWNoKGFzeW5jICh0KSA9PiB7XG4gIGNvbnN0IGFsaWNlID0gbmV3IFBhcmt5REIoKTtcbiAgYXdhaXQgYWxpY2UuaW5pdGlhbGl6ZSh7XG4gICAgLy8gUmVtZW1iZXIgdGhlc2UgdmFsdWVzIGNvbWUgZnJvbSBhIENMSSBvciBVSSwgRE8gTk9UIGhhcmRjb2RlIHdoZW4gaW1wbGVtZW50aW5nXG4gICAgd2l0aFdhbGxldDoge1xuICAgICAgcGFzc3dvcmQ6IFwicXdlcnR5XCIsXG4gICAgICBzZWVkOiBcIndpbmRvdyBhbHBoYSB2aWV3IHRleHQgYmFyZWx5IHVyZ2UgbWludXRlIG5hc3R5IG1vdGlvbiBjdXJ0YWluIG5lZWQgZGlub3NhdXJcIixcbiAgICB9LFxuICB9KTtcblxuICBjb25zdCBib2IgPSBuZXcgUGFya3lEQigpO1xuICBhd2FpdCBib2IuaW5pdGlhbGl6ZSh7XG4gICAgLy8gUmVtZW1iZXIgdGhlc2UgdmFsdWVzIGNvbWUgZnJvbSBhIENMSSBvciBVSSwgRE8gTk9UIGhhcmRjb2RlIHdoZW4gaW1wbGVtZW50aW5nXG4gICAgd2l0aFdhbGxldDoge1xuICAgICAgcGFzc3dvcmQ6IFwienhjdmJcIixcbiAgICAgIHNlZWQ6IFwib3BlcmEgb2ZmZXIgY3JhZnQgam9rZSBkZWZ5IHRlYW0gcHJvc3BlciB0cmFnaWMgcmVvcGVuIHN0cmVldCBhZHZpY2UgbW9yYWxcIixcbiAgICB9LFxuICB9KTtcblxuICB0LmNvbnRleHQgPSB7XG4gICAgZGI6IGFsaWNlLFxuICAgIGFsaWNlLFxuICAgIGJvYixcbiAgfTtcbn0pO1xudGVzdChcInJlbmRlciBzZXJ2ZXJcIiwgYXN5bmMgKHQpID0+IHtcbiAgY29uc3QgZGF0YSA9IGF3YWl0IG1haW4oKTtcbiAgY29uc29sZS5sb2coZGF0YSk7XG59KTtcbnRlc3QoXCJjcmVhdGUgdG9waWNcIiwgYXN5bmMgKHQpID0+IHtcbiAgY29uc3QgeyBhbGljZSwgYm9iIH06IHsgYWxpY2U6IFBhcmt5REI7IGJvYjogUGFya3lEQiB9ID1cbiAgICB0LmNvbnRleHQgYXMgYW55O1xuXG4gIGF3YWl0IGFsaWNlLndhbGxldC5hZGRTZWNwMjU2azEoW1xuICAgIFwiYzg3NTA5YTFjMDY3YmJkZTc4YmViNzkzZTZmYTc2NTMwYjYzODJhNGMwMjQxZTVlNGE5ZWMwYTBmNDRkYzBkM1wiLFxuICBdKTtcbiAgLy8gQHRzLWlnbm9yZVxuICBhd2FpdCBhbGljZS53YWxsZXQuc3VibWl0UGFzc3dvcmQoYHF3ZXJ0eWApO1xuICBsZXQgYWNjb3VudHMgPSBhd2FpdCBhbGljZS53YWxsZXQuZ2V0QWNjb3VudHMoKTtcbiAgdC5pcyhhY2NvdW50cy5sZW5ndGgsIDEpO1xuICBjb25zdCBhY2NvdW50QSA9IGFjY291bnRzWzBdO1xuXG4gIC8vIEB0cy1pZ25vcmVcbiAgYXdhaXQgYm9iLndhbGxldC5zdWJtaXRQYXNzd29yZChgenhjdmJgKTtcbiAgYWNjb3VudHMgPSBhd2FpdCBhbGljZS53YWxsZXQuZ2V0QWNjb3VudHMoKTtcbiAgdC5pcyhhY2NvdW50cy5sZW5ndGgsIDEpO1xuICBjb25zdCBhY2NvdW50QiA9IGFjY291bnRzWzBdO1xuXG4gIGNvbnN0IHRvcGljID0gYC9hbmNvbnByb3RvY29sLzEvbWFya2V0cGxhY2UvaXBsZC1kYWctanNvbmA7XG4gIGNvbnN0IHB1YnN1YkFsaWNlID0gYXdhaXQgYWxpY2UuY3JlYXRlVG9waWNQdWJzdWIodG9waWMpO1xuICBwdWJzdWJBbGljZS5vbkJsb2NrUmVwbHkkLnN1YnNjcmliZShhc3luYyAoYmxvY2s6IFdha3VNZXNzYWdlKSA9PiB7XG4gICAgLy8gbWF0Y2ggdG9waWNcbiAgICB0LmlzKHRvcGljLCBKU09OLnBhcnNlKGJsb2NrLnBheWxvYWRBc1V0ZjgpLnRvcGljKTtcbiAgfSk7XG4gIGNvbnN0IHB1YnN1YkJvYiA9IGF3YWl0IGJvYi5jcmVhdGVUb3BpY1B1YnN1Yih0b3BpYyk7XG4gIHB1YnN1YkJvYi5vbkJsb2NrUmVwbHkkLnN1YnNjcmliZShhc3luYyAoYmxvY2s6IFdha3VNZXNzYWdlKSA9PiB7XG4gICAgLy8gbWF0Y2ggdG9waWNcbiAgICB0LmlzKHRvcGljLCBKU09OLnBhcnNlKGJsb2NrLnBheWxvYWRBc1V0ZjgpLnRvcGljKTtcbiAgICBhd2FpdCBib2IucHV0QmxvY2socGF5bG9hZCwgeyB0b3BpYyB9KTtcbiAgfSk7XG5cbiAgLy8gU2F5IGhpXG4gIGF3YWl0IGFsaWNlLnB1dEJsb2NrKHBheWxvYWQsIHsgdG9waWMgfSk7XG59KTtcbiJdfQ==